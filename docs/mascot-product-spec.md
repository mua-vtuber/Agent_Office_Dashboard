# Agent Mascot - Product Specification

## 1. 개요

Agent Mascot은 Claude Code의 AI 에이전트 활동을 데스크탑 위의 캐릭터로 시각화하는 장식품 앱이다.
웹 브라우저를 열지 않아도 에이전트의 상태와 생각을 실시간으로 볼 수 있다.

## 2. 핵심 가치

- **자동**: 사용자가 별도로 실행하지 않는다. Claude Code에서 팀 에이전트가 시작되면 앱이 자동으로 뜬다.
- **비침습**: 작업을 방해하지 않는다. 투명 윈도우에 캐릭터만 표시되며, 클릭은 뒤로 통과한다.
- **한눈에**: 에이전트가 뭘 하고 있는지, 뭘 생각하고 있는지 말풍선 하나로 본다.

## 3. 사용자 시나리오

### 3.1 에이전트 등장
1. 사용자가 Claude Code에서 팀 에이전트를 실행한다.
2. `SubagentStart` hook이 발화된다.
3. Agent Mascot 앱이 실행되어 있지 않으면 자동으로 실행된다.
4. 데스크탑 하단에 캐릭터가 뿅 이펙트와 함께 등장한다.
5. 캐릭터 위에 프로젝트(워크스페이스) 이름 라벨이 표시된다.
6. 그 아래에 에이전트 이름이 표시된다.

### 3.2 작업 중 상태 표시
1. 에이전트가 도구를 사용하거나 작업을 수행한다.
2. 캐릭터의 애니메이션이 working 상태로 전환된다.
3. 말풍선에 현재 작업 내용이 표시된다.
4. 에이전트의 thinking(확장 사고) 내용이 있으면 말풍선에 표시된다.

### 3.3 에이전트 퇴장
1. 에이전트가 작업을 완료하거나 종료된다.
2. `SubagentStop` hook이 발화된다.
3. 캐릭터가 퇴장 애니메이션 후 사라진다.

### 3.4 이력서 모달
1. 데스크탑 우상단의 이력서 아이콘을 클릭한다 (또는 시스템 트레이 메뉴에서 선택).
2. 에이전트 목록이 이력서 형태의 모달로 표시된다.
3. 정규직(employee)/계약직(contractor)으로 분류된다.
4. 에이전트를 선택하면 상세 정보를 볼 수 있다:
   - 이름, 역할, 고용 형태
   - 현재 상태, 진행 중인 작업
   - 최근 활동 이력
   - 생각(thinking) 내용

### 3.5 멀티 터미널
1. 여러 터미널에서 각각 다른 프로젝트의 에이전트가 실행된다.
2. 캐릭터들은 프로젝트별로 그룹화되어 배치된다.
3. 각 그룹 위에 프로젝트 이름 라벨이 표시된다 (게임의 길드명처럼).
4. 이력서 모달에서도 프로젝트별로 섹션이 구분된다.

## 4. 화면 구성

### 4.1 메인 윈도우 (투명 오버레이)
```
┌──────────────────────────────────────────────────────┐
│                                                [📋]  │ ← 이력서 아이콘
│  (이 영역은 전부 클릭 통과 — 사용자 작업 방해 안 함)  │
│                                                      │
│                                                      │
│                                                      │
│ ─ ─ ─ ─ ─ ─ ─ ─ 캐릭터 활동 영역 ─ ─ ─ ─ ─ ─ ─ ─ ─│ ← 화면 하단, 작업표시줄 바로 위
│  ┌─my-project─┐       ┌─api-server─┐                │
│  │  agent-01   │       │   leader   │                │
│  └─────────────┘       └────────────┘                │
│    ┌───────┐             ┌───────┐                   │
│    │ 수정중│             │테스트중│                   │
│    └──┬────┘             └──┬────┘                   │
│    (캐릭터) ←→ (약간 이동)  (캐릭터)                  │
├──────────────────────────────────────────────────────┤
│ [작업표시줄]                                          │
└──────────────────────────────────────────────────────┘
```

- 배경: 완전 투명
- 캐릭터는 **화면 하단 작업표시줄 바로 위 영역**에만 존재
- 캐릭터 영역만 클릭 가능, 나머지는 클릭 통과
- 이력서 아이콘: 우상단 고정
- 캐릭터는 좁은 영역 안에서만 약간의 좌우 이동 (자유롭게 돌아다니지 않음)
- 시야를 가리지 않는 것이 최우선

### 4.1.1 캐릭터 움직임 규칙
- **활동 영역**: 화면 하단에서 작업표시줄 높이만큼 위의 좁은 띠 (config로 높이 설정)
- **이동**: 같은 그룹 내에서 약간의 좌우 이동만 (idle 시 미세한 흔들림 정도)
- **작업 완료 시**: 폴짝폴짝 뛰는 기쁨 애니메이션 (`celebrate` animation)
- **절대 안 함**: 화면 중앙으로 이동, 다른 영역 침범, 시야 가리기

### 4.2 이력서 모달
```
┌──────────────────────────────────────┐
│  에이전트 이력서                [X]  │
│  ┌──────┐  ┌──────┐  ┌──────┐      │
│  │ 전체  │  │정규직│  │계약직│      │
│  └──────┘  └──────┘  └──────┘      │
│                                      │
│  ── my-project ──────────────────── │
│                                      │
│  ┌──────────────────────────────┐   │
│  │ [캐릭터] agent-01             │   │
│  │          Worker / 정규직      │   │
│  │          상태: 작업중          │   │
│  │          작업: 인증 모듈 수정  │   │
│  └──────────────────────────────┘   │
│                                      │
│  ── api-server ──────────────────── │
│                                      │
│  ┌──────────────────────────────┐   │
│  │ [캐릭터] leader               │   │
│  │          Manager / 정규직     │   │
│  │          상태: 작업중          │   │
│  │          작업: API 테스트      │   │
│  └──────────────────────────────┘   │
└──────────────────────────────────────┘
```

### 4.3 시스템 트레이 메뉴
```
┌─────────────────┐
│ 마스코트 표시    │
│ 에이전트 이력서  │
│ ─────────────── │
│ 언어: 한국어 ▸  │
│ 자동 실행: ✓    │
│ ─────────────── │
│ 종료            │
└─────────────────┘
```

## 5. 설계 원칙

1. **설정 기반 동적 구현** — 하드코딩 금지. 포트, 간격, 타이머 값, 말풍선 길이 등 모든 수치는 `config.toml` 또는 런타임 데이터에서 로드.
2. **오류는 폴백으로 가리지 않음** — 모든 오류는 사용자에게 명시적으로 표시. Spine 로드 실패, 서버 바인드 실패, DB 오류 등 모두 에러 다이얼로그/토스트.
3. **코드 품질 우선** — 작업량보다 정확성과 타입 안전성을 우선. Rust: `Result<T,E>` 필수, `.unwrap()` 금지. TypeScript: strict 모드.
4. **효율적인 구조** — 불필요한 추상화 없이 모듈 간 책임 명확 분리. 레이어 간 의존성 단방향.

## 6. 비목표 (Non-goals)

- 사무실 레이아웃/공간 시뮬레이션 (삭제)
- 경로 탐색/A* pathfinding (삭제)
- 대시보드 페이지 (삭제)
- 설정 페이지 UI (트레이 메뉴 + config.toml로 대체)
- 웹 브라우저 기반 접근

## 7. 기술 스택

| 계층 | 기술 | 용도 |
|------|------|------|
| 데스크탑 프레임워크 | Tauri v2 | 투명 윈도우, 시스템 트레이, IPC |
| 백엔드 언어 | Rust | 전면 사용, 타협 없음 |
| HTTP 서버 | axum | hooks 수신 (내장) |
| 데이터베이스 | SQLite (rusqlite) | 에이전트/이벤트 저장 |
| 프론트엔드 | React + TypeScript | WebView UI |
| 렌더링 | PixiJS v8 | 캔버스 렌더링 |
| 캐릭터 애니메이션 | Spine 2D | 스켈레탈 애니메이션 + 스킨 시스템 |
| 상태 관리 | Zustand v5 | 프론트엔드 상태 |
| 번들러 | Vite | 프론트엔드 빌드 |
| 다국어 | i18next | ko/en |

## 8. 성능 목표

| 지표 | 목표 |
|------|------|
| 앱 메모리 (idle) | < 80MB |
| 앱 메모리 (에이전트 10개) | < 150MB |
| hook 수신 → 화면 반영 | < 500ms |
| 캐릭터 렌더링 FPS | 60fps |
| 앱 시작 시간 | < 3초 |
| 설치 파일 크기 | < 15MB |

## 9. 결정 로그

| 날짜 | 결정 | 이유 |
|------|------|------|
| 2026-02-20 | 웹 대시보드 → 데스크탑 마스코트 전환 | 웹페이지를 일부러 켜야 하는 불편함 제거 |
| 2026-02-20 | Electron 대신 Tauri v2 선택 | 장식품은 항상 떠있으므로 메모리 효율 중요 (50MB vs 300MB) |
| 2026-02-20 | SVG 캐릭터 → Spine 2D 전환 | 사용자가 Spine 작업 가능, 프로 품질 애니메이션 + 내장 스킨 시스템 |
| 2026-02-20 | 설정 페이지 삭제 | 장식품에 과한 UI. 트레이 메뉴 + config.toml로 충분 |
| 2026-02-20 | Rust 전면 사용 (최소 타협 X) | 제대로 만들기로 결정 |
